
[ req ]
default_bits        = 2048
default_md          = sha256
prompt              = no
encrypt_key         = no
distinguished_name  = dn_ca_intermediaria
req_extensions      = v3_ca_intermediaria

[ dn_ca_intermediaria ]
C                   = BR
ST                  = RS
L                   = Parobe
O                   = Minha ICP Local
CN                  = AC Intermediaria - PKI Local

[ v3_ca_intermediaria ]
subjectKeyIdentifier    = hash
basicConstraints        = critical, CA:true, pathlen:0 # **CRUCIAL: pathlen=0**
keyUsage                = critical, keyCertSign, cRLSign

[ v3_servidor ]
subjectKeyIdentifier    = hash
authorityKeyIdentifier  = keyid:always,issuer:always
basicConstraints        = CA:false
keyUsage                = digitalSignature, keyEncipherment
extendedKeyUsage        = serverAuth
subjectAltName          = DNS:web.local
authorityInfoAccess     = OCSP;URI:http://pki.local/ocsp, caIssuers;URI:http://pki.local/intermediaria.crt
crlDistributionPoints   = URI:http://pki.local/crl/intermediaria.crl

[ ca ]
default_ca = default_ca

[ default_ca ]
dir                     = .                     
certs                   = $dir/certs           
new_certs_dir           = $dir/newcerts
database                = $dir/database/index.txt
serial                  = $dir/database/serial
crlnumber               = $dir/database/crlnumber
crl                     = $dir/crl/intermediaria.crl
private_key             = $dir/private/intermediaria.key 
certificate             = $dir/certs/intermediaria.crt   
default_days            = 364                   
default_crl_days        = 30
default_md              = sha256
policy                  = policy_anything

[ policy_anything ]
countryName             = optional
stateOrProvinceName     = optional
organizationName        = optional
organizationalUnitName  = optional
commonName              = supplied
emailAddress            = optional